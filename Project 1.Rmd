---
title: "Stastical Inference Assignment"
author: "Abhay Singh"
date: "09/02/2021"
output: pdf_document
---

# Part 1: Simulation Exercise 

In this project you will investigate the exponential distribution in R and compare it with the Central Limit Theorem. The exponential distribution can be simulated in R with rexp(n, lambda) where lambda is the rate parameter. The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda. Set lambda = 0.2 for all of the simulations. You will investigate the distribution of averages of 40 exponentials. Note that you will need to do a thousand simulations.

```{r echo=TRUE}
library(ggplot2)
library(tinytex)
set.seed(1234)
lambda <- 0.2
n <- 40
sim_data <- replicate(1000,rexp(n,lambda))
mean_sim_data <- apply(sim_data, 2, mean)

```

# Mean Comparision

Sample Mean vs Theoretical Mean of the Distribution

```{r echo=TRUE}
#Finding the sample Mean

sampleMean <- mean(mean_sim_data)
print(paste("Sample Mean = ",sampleMean))

# Theoretical Mean
theoretical_mean <- (1/lambda)

print(paste("Theoretical Mean = ",theoretical_mean))

```
# Histogram shows difference

```{r echo=FALSE}
hist(mean_sim_data, col="light blue", xlab = "Mean Average", main="Distribution of Exponential Average")
abline(v = theoretical_mean, col="brown")
abline(v = sampleMean, col="green")

```

Question 2: Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution

Calculating the theoretical and sample variance
```{r}
# sample deviation & variance
sample_dev <- sd(mean_sim_data)
sample_dev
sample_variance <- sample_dev^2
sample_variance
```

```{r}
# theoretical deviation & variance
theoretical_dev <- (1/lambda)/sqrt(n)
theoretical_dev
theoretical_variance <- ((1/lambda)*(1/sqrt(n)))^2
theoretical_variance
```
Question 3: Show that the distribution is approximately normal
Histogram with Density and sample means:
```{r}
d <- data.frame(mean_sim_data)
t <- data.frame(theoretical_mean)
g <- ggplot(d, aes(x = mean_sim_data)) +
geom_histogram(binwidth = .2, color="black", fill="brown" , aes(y=..density..))+stat_function(fun=dnorm, args=list(mean=theoretical_mean, sd=sd(mean_sim_data)),color="green", size =1) +stat_density(geom = "line", color = "blue", size =1)  +labs(x="Mean", y= "Density", title="Normal Distribution Comparision")
g
```
The above plot indicated that density curve is similar to normal distribution curve.

Q-Q Normal Plot also indicates the normal distribution
```{r}
qqnorm(mean_sim_data)
 qqline(mean_sim_data, col = "magenta")
```